"0",""
"0","class_diag<-function(probs,truth){"
"0",""
"0","tab<-table(factor(probs>.5,levels=c(""FALSE"",""TRUE"")),truth)"
"0","acc=sum(diag(tab))/sum(tab)"
"0","sens=tab[2,2]/colSums(tab)[2]"
"0","spec=tab[1,1]/colSums(tab)[1]"
"0","ppv=tab[2,2]/rowSums(tab)[2]"
"0",""
"0","if(is.numeric(truth)==FALSE & is.logical(truth)==FALSE) truth<-as.numeric(truth)-1"
"0",""
"0","ord<-order(probs, decreasing=TRUE)"
"0","probs <- probs[ord]; truth <- truth[ord]"
"0",""
"0","TPR=cumsum(truth)/max(1,sum(truth)) "
"0","FPR=cumsum(!truth)/max(1,sum(!truth))"
"0",""
"0","dup<-c(probs[-1]>=probs[-length(probs)], FALSE)"
"0","TPR<-c(0,TPR[!dup],1); FPR<-c(0,FPR[!dup],1)"
"0",""
"0","n <- length(TPR)"
"0","auc<- sum( ((TPR[-1]+TPR[-n])/2) * (FPR[-1]-FPR[-n]) )"
"0",""
"0","data.frame(acc,sens,spec,ppv,auc)"
"0","}"
"0",""
"0",""
"0","set.seed(1234)"
"0","k=10"
"0",""
"0","data1<-salaries[sample(nrow(salaries)),]"
"0","folds<-cut(seq(1:nrow(salaries)),breaks=k,labels=F)"
"0",""
"0","diags<-NULL"
"0","for(i in 1:k){"
"0","train<-data1[folds!=i,]"
"0","test<-data1[folds==i,]"
"0","truth<-test$mf"
"0","fit12<- glm(mf~salary_c+rank,data=train,family=binomial(link=""logit""))"
"0","probs<- predict(fit12, newdata=test, type=""response"")"
"0","diags<-rbind(diags,class_diag(probs,truth))}"
"0",""
"0","apply(diags,2,mean)"
"1","      acc "
"1","     sens "
"1","     spec "
"1","      ppv "
"1","
"
"1","0.9016667 "
"1","0.0000000 "
"1","1.0000000 "
"1","      NaN "
"1","
"
"1","      auc "
"1","
"
"1","0.6659604 "
"1","
"
